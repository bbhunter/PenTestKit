## AD Notes

#### Responder

```
responder -I eth0 -w -d
```

---

#### Find DC server

```
nslookup -type=SRV _ldap._tcp.dc._msdcs.[domain name]
```

```
nmap --reason --open -n -Pn -T4 -sS -p53,88,389,636,464 -oA dc_servers [ip-range]
```

#### Find Domain name

```
nmap -sS -A -Pn -T4 --osscan-guess --version-all -p53,88,389,636,464 -oA domain_name [dc-ip]
```

---

#### Find smb vulns

```
nmap -PN --script smb-vuln* -p139,445 -oA smb_vulns [dc-ip]
```

---

#### Find guest access on smb share

```
enum4linux -a -u "" -p "" [dc-ip] && enum4linux -a -u "guest" -p "" [dc-ip]
```

```
smbmap -u "" -p "" -P 445 -H [dc-ip] && smbmap -u "guest" -p "" -P 445 -H [dc-ip]
```

```
smbclient -U '%' -L //[dc-ip] && smbclient -U 'guest%' -L //[dc-ip]
```

```
crackmapexec smb [dc-ip] -u '' -p ''
```

```
crackmapexec smb [dc-ip] -u 'a' -p ''
```

---

#### Enumerate LDAP

```
nmap -n -sV --script "ldap* and not brute" -p389 -oA ldap_enum [dc-ip]
```

```
ldapsearch -x -H ldap://[dc-ip] -s base -D '' -w ''
```

---

#### Find users

```
enum4linux -U [dc-ip] | grep 'user:'
```

```
crackmapexec smb [dc-ip] -u '' -p '' --users
```

```
crackmapexec smb [dc-ip] -u '[username]' -p '[password]' --users
```

```
nmap -p88 --script=krb5-enum-users --script-args="krb5-enum-users.realm='[domain name]',userdb=[users_list]" -oA users_enum [dc-ip]
```

---

#### Find smb not signed

```
nmap -Pn -sS -T4 --open -p445 --script smb-security-mode -oA smb_not_signed [ip-range]
```

---

